@page "/register"
@using Teste.Ui.Services
@using Teste.Ui.Models
@inject IAuthService AuthService
@inject NavigationManager Nav

<div class="auth-container">
    <div class="auth-card">
        <h2 class="auth-title">Criar conta</h2>

        <input class="auth-input"
               @bind="request.Email"
               placeholder="Email"
               type="email" />

        <input class="auth-input"
               @bind="request.Password"
               placeholder="Senha"
               type="password" />

        <input class="auth-input"
               @bind="request.ConfirmPassword"
               placeholder="Confirmar senha"
               type="password" />

        <button class="auth-button" @onclick="RegisterUser">
            Registrar
        </button>

        @if (!string.IsNullOrWhiteSpace(message))
        {
            <p class="auth-message">@message</p>
        }

        <p class="auth-footer">
            Já tem conta?
            <a href="javascript:void(0);" @onclick="NavigateToLogin">
                Entrar
            </a>
        </p>
    </div>
</div>

@code {
    private RegisterRequest request = new();
    private string message = string.Empty;

    private async Task RegisterUser()
    {
        var success = await AuthService.RegisterAsync(request);

        if (success)
        {
            message = "Usuário registrado com sucesso!";
            await Task.Delay(1200);
            Nav.NavigateTo("/login");
        }
        else
        {
            message = "Erro ao registrar usuário.";
        }
    }

    private void NavigateToLogin()
    {
        Nav.NavigateTo("/login");
    }
}
